{"ast":null,"code":"import _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../components/layout/Layout';\nimport fetch from 'isomorphic-unfetch';\nimport absoluteUrl from 'next-absolute-url';\nimport PollPagination from '../components/poll/PollPagination';\nimport PollCard from '../components/poll/PollCard';\nimport { withRouter } from 'next/router';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport VoteHistory from '../components/VoteHistory';\nimport Router from 'next/router';\nimport PollListFilter from '../components/poll/PollListFilter';\n\nclass Home extends React.Component {\n  static async getInitialProps(ctx) {\n    const {\n      origin\n    } = absoluteUrl(ctx.req);\n    const {\n      page,\n      state\n    } = ctx.query;\n    let queryString = '';\n\n    for (let i = 0; i < _Object$keys(ctx.query).length; i++) {\n      let name = _Object$keys(ctx.query)[i];\n\n      let value = ctx.query[_Object$keys(ctx.query)[i]];\n\n      if (value !== undefined && value !== '') {\n        if (i > 0) {\n          queryString += '&';\n        }\n\n        queryString += `${name}=${value}`;\n      }\n    } // const searchPage = page < 1 || page == undefined ? 1 : page;\n\n\n    const res = await fetch(`${origin}/api/v1/polls?${queryString}`, {\n      method: 'POST'\n    });\n    const data = await res.json();\n    return {\n      polls: data.pollsArr,\n      totalItems: data.totalItems\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    this.updateFilter = this.updateFilter.bind(this);\n  }\n\n  updateFilter(eventKey) {\n    const {\n      state\n    } = this.props.router.query;\n    let href = '/?page=1';\n\n    if (state !== eventKey) {\n      href += `&state=${eventKey}`;\n      const as = href;\n      Router.push(href, as);\n    }\n  }\n\n  render() {\n    const {\n      polls,\n      totalItems\n    } = this.props;\n    return __jsx(Layout, {\n      pageTitle: \"ThatPoll\",\n      path: this.props.router.asPath,\n      ads: true\n    }, __jsx(Row, null, __jsx(Col, {\n      md: 9,\n      style: {\n        display: 'flex',\n        justifyContent: 'space-between'\n      }\n    }, __jsx(\"h4\", {\n      className: \"page-header\",\n      style: {\n        padding: 0\n      }\n    }, \"Recent Polls\"), __jsx(PollListFilter, {\n      updateFilter: this.updateFilter,\n      query: this.props.router.query\n    }))), __jsx(\"hr\", null), __jsx(Row, null, __jsx(Col, {\n      md: 9\n    }, polls.length === 0 ? __jsx(\"div\", {\n      className: \"no-polls-card\"\n    }, __jsx(\"h4\", null, \"No Polls Found\")) : __jsx(\"div\", null, polls.map((poll, i) => __jsx(PollCard, {\n      key: i,\n      poll: poll\n    })), __jsx(PollPagination, {\n      totalItems: totalItems\n    }))), __jsx(Col, null, __jsx(VoteHistory, null))));\n  }\n\n}\n\nexport default withRouter(Home);","map":{"version":3,"sources":["E:/Users/Jordan/Desktop/thatpoll/pages/index.js"],"names":["Layout","fetch","absoluteUrl","PollPagination","PollCard","withRouter","Row","Col","VoteHistory","Router","PollListFilter","Home","React","Component","getInitialProps","ctx","origin","req","page","state","query","queryString","i","length","name","value","undefined","res","method","data","json","polls","pollsArr","totalItems","constructor","props","updateFilter","bind","eventKey","router","href","as","push","render","asPath","display","justifyContent","padding","map","poll"],"mappings":"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","sourcesContent":["import Layout from '../components/layout/Layout';\nimport fetch from 'isomorphic-unfetch';\nimport absoluteUrl from 'next-absolute-url';\nimport PollPagination from '../components/poll/PollPagination';\nimport PollCard from '../components/poll/PollCard';\nimport { withRouter } from 'next/router';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport VoteHistory from '../components/VoteHistory';\nimport Router from 'next/router';\nimport PollListFilter from '../components/poll/PollListFilter';\n\nclass Home extends React.Component {\n  static async getInitialProps(ctx) {\n    const { origin } = absoluteUrl(ctx.req);\n    const { page, state } = ctx.query;\n    let queryString = '';\n    for (let i = 0; i < Object.keys(ctx.query).length; i++) {\n      let name = Object.keys(ctx.query)[i];\n      let value = ctx.query[Object.keys(ctx.query)[i]];\n\n      if (value !== undefined && value !== '') {\n        if (i > 0) {\n          queryString += '&';\n        }\n        queryString += `${name}=${value}`;\n      }\n\n    }\n    // const searchPage = page < 1 || page == undefined ? 1 : page;\n\n    const res = await fetch(`${origin}/api/v1/polls?${queryString}`, {\n      method: 'POST',\n    });\n    const data = await res.json();\n  \n    return {\n      polls: data.pollsArr,\n      totalItems: data.totalItems\n    }\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.updateFilter = this.updateFilter.bind(this);\n  }\n\n  updateFilter(eventKey) {\n    const { state } = this.props.router.query;\n    let href = '/?page=1';\n    if (state !== eventKey) {\n      href += `&state=${eventKey}`\n      const as = href;\n      Router.push(href, as);\n    }\n  }\n\n  render() {\n    const { polls, totalItems } = this.props;\n    return (\n      <Layout\n        pageTitle='ThatPoll'\n        path={this.props.router.asPath}\n        ads={true}\n      >\n        <Row>\n          <Col md={9} style={{ display: 'flex', justifyContent: 'space-between' }}>\n            <h4 className='page-header' style={{ padding: 0 }}>Recent Polls</h4>\n            <PollListFilter updateFilter={this.updateFilter} query={this.props.router.query} />\n          </Col>\n        </Row>\n        <hr />\n        \n        <Row>\n          <Col md={9}>\n            { polls.length === 0 ?\n              <div className='no-polls-card'>\n                <h4>No Polls Found</h4>\n              </div>\n            :\n              <div>\n                {polls.map((poll, i) => (\n                  <PollCard key={i} poll={poll} />\n                ))}\n                <PollPagination totalItems={totalItems} />\n              </div>\n            }\n          </Col>\n          <Col>\n            <VoteHistory />\n          </Col>\n        </Row>\n      </Layout>\n    )\n  }\n}\n\nexport default withRouter(Home)\n"]},"metadata":{},"sourceType":"module"}