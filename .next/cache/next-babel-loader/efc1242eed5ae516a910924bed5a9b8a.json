{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../components/Layout';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport Col from 'react-bootstrap/Col';\nimport Alert from 'react-bootstrap/Alert';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPoll, faQuestionCircle, faEye } from '@fortawesome/free-solid-svg-icons';\nimport PollPreview from '../components/PollPreview';\nimport Router from 'next/router';\nimport absoluteUrl from 'next-absolute-url';\nimport moment from 'moment';\nimport 'moment-precise-range-plugin'; //TO DO ##############################################\n//Validate Poll Inputs\n\nfunction validatePollInput(pollDataObj) {\n  var choices = [pollDataObj.choice1, pollDataObj.choice2];\n\n  if (pollDataObj.choice3 !== '') {\n    choices.push(pollDataObj.choice3);\n  }\n\n  if (pollDataObj.choice4 !== '') {\n    choices.push(pollDataObj.choice4);\n  }\n\n  var pollData = {\n    title: pollDataObj.title,\n    desc: pollDataObj.desc,\n    choices: choices,\n    visibility: pollDataObj.visibility,\n    votingPeriod: pollDataObj.votingPeriod\n  };\n  return pollData;\n}\n\nvar CreatePoll =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(CreatePoll, _React$Component);\n\n  function CreatePoll() {\n    var _this;\n\n    _classCallCheck(this, CreatePoll);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CreatePoll).call(this));\n    _this.state = {\n      title: '',\n      desc: '',\n      choice1: '',\n      choice2: '',\n      choice3: '',\n      choice4: '',\n      visibility: 'public',\n      votingPeriod: 6,\n      dateCreated: new Date(),\n      error: false,\n      timelimit: 'Voting ends in: 6 hours'\n    };\n    _this.inputUpdate = _this.inputUpdate.bind(_assertThisInitialized(_this));\n    _this.visibilityUpdate = _this.visibilityUpdate.bind(_assertThisInitialized(_this));\n    _this.handleSubmit = _this.handleSubmit.bind(_assertThisInitialized(_this));\n    _this.updateTimePeriod = _this.updateTimePeriod.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(CreatePoll, [{\n    key: \"inputUpdate\",\n    value: function inputUpdate(e) {\n      this.setState(_defineProperty({}, e.target.name, e.target.value));\n    }\n  }, {\n    key: \"visibilityUpdate\",\n    value: function visibilityUpdate(e) {\n      this.setState({\n        visibility: e.target.value\n      });\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function () {\n      var _handleSubmit = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e, req) {\n        var _absoluteUrl, origin, pollData, res, data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n                _absoluteUrl = absoluteUrl(req), origin = _absoluteUrl.origin;\n                pollData = validatePollInput(this.state);\n                _context.prev = 3;\n                _context.next = 6;\n                return fetch(\"\".concat(origin, \"/api/create-poll\"), {\n                  method: 'POST',\n                  headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json',\n                    'X-Origin': 'statmix'\n                  },\n                  body: _JSON$stringify(pollData)\n                });\n\n              case 6:\n                res = _context.sent;\n                _context.next = 9;\n                return res.json();\n\n              case 9:\n                data = _context.sent;\n\n                if (data.message === 'success') {\n                  Router.push(\"/poll/\".concat(data.url));\n                } else {\n                  this.setState({\n                    error: true\n                  });\n                  window.scrollTo({\n                    top: 56,\n                    left: 0,\n                    behavior: 'smooth'\n                  });\n                } //console.log(data);\n\n\n                _context.next = 15;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](3);\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[3, 13]]);\n      }));\n\n      function handleSubmit(_x, _x2) {\n        return _handleSubmit.apply(this, arguments);\n      }\n\n      return handleSubmit;\n    }()\n  }, {\n    key: \"updateTimePeriod\",\n    value: function updateTimePeriod(e) {\n      var _this$setState2;\n\n      var endTime = moment(this.state.dateCreated, 'YYYY-MM-DD HH:mm:ss').add(e.target.value, 'hours');\n      var currentTime = moment(new Date(), 'YYYY-MM-DD HH:mm:ss');\n      var timelimit = 'Voting ends in:';\n      var diff = moment.preciseDiff(endTime, currentTime, true);\n      var days = diff.days;\n      var hours = diff.hours;\n      var minutes = diff.minutes;\n      if (days > 0) timelimit += \" \".concat(days, \" days\");\n      if (hours > 0) timelimit += \" \".concat(hours, \" hours\");\n      if (minutes > 0) timelimit += \" \".concat(minutes, \" minutes\");\n      this.setState((_this$setState2 = {}, _defineProperty(_this$setState2, e.target.name, e.target.value), _defineProperty(_this$setState2, \"timelimit\", timelimit), _this$setState2));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          title = _this$state.title,\n          desc = _this$state.desc,\n          choice1 = _this$state.choice1,\n          choice2 = _this$state.choice2,\n          choice3 = _this$state.choice3,\n          choice4 = _this$state.choice4,\n          votingPeriod = _this$state.votingPeriod,\n          error = _this$state.error;\n      return __jsx(Layout, {\n        pageTitle: \"Create Poll\"\n      }, __jsx(\"h4\", {\n        className: \"page-header\"\n      }, __jsx(FontAwesomeIcon, {\n        icon: faPoll\n      }), \" Create Poll\"), __jsx(\"hr\", null), error ? __jsx(Alert, {\n        variant: \"danger\"\n      }, __jsx(\"b\", null, \"Error submitting poll\")) : null, __jsx(Form, {\n        autoComplete: \"off\",\n        onSubmit: this.handleSubmit\n      }, __jsx(Form.Group, null, __jsx(Form.Label, null, \"Title\"), __jsx(Form.Control, {\n        value: title,\n        onChange: this.inputUpdate,\n        type: \"text\",\n        name: \"title\",\n        maxLength: \"100\",\n        required: true\n      })), __jsx(Form.Group, null, __jsx(Form.Label, null, \"Description (Optional)\"), __jsx(Form.Control, {\n        value: desc,\n        onChange: this.inputUpdate,\n        style: {\n          'maxHeight': '144px',\n          minHeight: '72px'\n        },\n        as: \"textarea\",\n        rows: \"3\",\n        name: \"desc\",\n        maxLength: \"400\"\n      }), __jsx(Form.Text, null, \"Characters remaining: \", 400 - desc.length)), __jsx(Form.Row, null, __jsx(Form.Group, {\n        as: Col\n      }, __jsx(Form.Label, null, \"Choice #1\"), __jsx(Form.Control, {\n        value: choice1,\n        onChange: this.inputUpdate,\n        type: \"text\",\n        name: \"choice1\",\n        maxLength: \"50\",\n        required: true\n      })), __jsx(Form.Group, {\n        as: Col\n      }, __jsx(Form.Label, null, \"Choice #2\"), __jsx(Form.Control, {\n        value: choice2,\n        onChange: this.inputUpdate,\n        type: \"text\",\n        name: \"choice2\",\n        maxLength: \"50\",\n        required: true\n      }))), __jsx(Form.Row, null, __jsx(Form.Group, {\n        as: Col\n      }, __jsx(Form.Label, null, \"Choice #3 (Optional)\"), __jsx(Form.Control, {\n        value: choice3,\n        onChange: this.inputUpdate,\n        type: \"text\",\n        name: \"choice3\",\n        maxLength: \"50\"\n      })), __jsx(Form.Group, {\n        as: Col\n      }, __jsx(Form.Label, null, \"Choice #4 (Optional)\"), __jsx(Form.Control, {\n        value: choice4,\n        onChange: this.inputUpdate,\n        type: \"text\",\n        name: \"choice4\",\n        maxLength: \"50\"\n      }))), __jsx(\"hr\", null), __jsx(Form.Row, null, __jsx(Form.Group, {\n        as: Col\n      }, __jsx(Form.Label, null, \"Visibility \", __jsx(FontAwesomeIcon, {\n        icon: faQuestionCircle\n      })), __jsx(Form.Check, {\n        onClick: this.visibilityUpdate,\n        type: \"radio\",\n        label: \"Public\",\n        name: \"visibility\",\n        value: \"public\",\n        defaultChecked: true\n      }), __jsx(Form.Check, {\n        onClick: this.visibilityUpdate,\n        type: \"radio\",\n        label: \"Private\",\n        name: \"visibility\",\n        value: \"private\"\n      })), __jsx(Form.Group, {\n        as: Col\n      }, __jsx(Form.Label, null, \"Voting Period (hours) \", __jsx(FontAwesomeIcon, {\n        icon: faQuestionCircle\n      })), __jsx(Form.Control, {\n        value: votingPeriod,\n        onChange: this.updateTimePeriod,\n        style: {\n          maxWidth: '200px'\n        },\n        type: \"number\",\n        min: \"6\",\n        max: \"72\",\n        name: \"votingPeriod\"\n      }), __jsx(Form.Text, null, \"6h - 72h\"))), __jsx(\"div\", {\n        className: \"poll-preview\"\n      }, __jsx(\"h4\", {\n        className: \"page-header\"\n      }, __jsx(FontAwesomeIcon, {\n        icon: faEye\n      }), \" Preview\"), __jsx(\"hr\", null), __jsx(PollPreview, this.state)), __jsx(\"hr\", null), __jsx(Form.Group, {\n        style: {\n          display: 'flex',\n          justifyContent: 'center',\n          marginTop: '2rem'\n        }\n      }, __jsx(Button, {\n        variant: \"light-blue\",\n        type: \"submit\",\n        style: {\n          width: '200px'\n        }\n      }, \"Create Poll\"))));\n    }\n  }]);\n\n  return CreatePoll;\n}(React.Component);\n\nexport default CreatePoll;","map":{"version":3,"sources":["E:/Users/Jordan/Desktop/statmix/pages/create-poll.js"],"names":["Layout","Form","Button","Col","Alert","FontAwesomeIcon","faPoll","faQuestionCircle","faEye","PollPreview","Router","absoluteUrl","moment","validatePollInput","pollDataObj","choices","choice1","choice2","choice3","push","choice4","pollData","title","desc","visibility","votingPeriod","CreatePoll","state","dateCreated","Date","error","timelimit","inputUpdate","bind","visibilityUpdate","handleSubmit","updateTimePeriod","e","setState","target","name","value","req","preventDefault","origin","fetch","method","headers","body","res","json","data","message","url","window","scrollTo","top","left","behavior","endTime","add","currentTime","diff","preciseDiff","days","hours","minutes","minHeight","length","maxWidth","display","justifyContent","marginTop","width","React","Component"],"mappings":"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","sourcesContent":["import Layout from '../components/Layout';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport Col from 'react-bootstrap/Col';\nimport Alert from 'react-bootstrap/Alert';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPoll, faQuestionCircle, faEye } from '@fortawesome/free-solid-svg-icons';\nimport PollPreview from '../components/PollPreview';\nimport Router from 'next/router';\nimport absoluteUrl from 'next-absolute-url';\nimport moment from 'moment';\nimport 'moment-precise-range-plugin';\n\n//TO DO ##############################################\n//Validate Poll Inputs\n\nfunction validatePollInput(pollDataObj) {\n  let choices = [pollDataObj.choice1, pollDataObj.choice2];\n  if(pollDataObj.choice3 !== '') {\n    choices.push(pollDataObj.choice3);\n  }\n  if(pollDataObj.choice4 !== '') {\n    choices.push(pollDataObj.choice4);\n  }\n\n  const pollData = {\n    title: pollDataObj.title,\n    desc: pollDataObj.desc,\n    choices: choices,\n    visibility: pollDataObj.visibility,\n    votingPeriod: pollDataObj.votingPeriod\n  }\n\n  return pollData;\n}\n\nclass CreatePoll extends React.Component {\n  constructor() {\n    super();\n\n    this.state = {\n      title: '',\n      desc: '',\n      choice1: '',\n      choice2: '',\n      choice3: '',\n      choice4: '',\n      visibility: 'public',\n      votingPeriod: 6,\n      dateCreated: new Date(),\n      error: false,\n      timelimit: 'Voting ends in: 6 hours'\n    }\n\n    this.inputUpdate = this.inputUpdate.bind(this);\n    this.visibilityUpdate = this.visibilityUpdate.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.updateTimePeriod = this.updateTimePeriod.bind(this);\n  }\n\n  inputUpdate(e) {\n    this.setState({ [e.target.name]: e.target.value })\n  }\n\n  visibilityUpdate(e) {\n    this.setState({ visibility: e.target.value });\n  }\n\n  async handleSubmit(e, req) {\n    e.preventDefault();\n    const { origin } = absoluteUrl(req);\n    const pollData = validatePollInput(this.state);\n    try {\n      const res = await fetch(`${origin}/api/create-poll`, {\n        method: 'POST',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json',\n          'X-Origin': 'statmix'\n        },\n        body: JSON.stringify(pollData)\n      });\n      const data = await res.json();\n      if(data.message === 'success') {\n        Router.push(`/poll/${data.url}`);\n      } else {\n        this.setState({ error: true });\n        window.scrollTo({\n          top: 56,\n          left: 0,\n          behavior: 'smooth'\n        });\n      }\n      //console.log(data);\n    } catch(err) {\n      //console.log(err)\n    }\n  }\n\n  updateTimePeriod(e) {\n    const endTime = moment(this.state.dateCreated,'YYYY-MM-DD HH:mm:ss').add(e.target.value, 'hours');\n    const currentTime = moment(new Date(),'YYYY-MM-DD HH:mm:ss');\n    let timelimit = 'Voting ends in:';\n    const diff = moment.preciseDiff(endTime, currentTime, true);\n    const days = diff.days;\n    const hours = diff.hours;\n    const minutes = diff.minutes;\n    if(days > 0) timelimit += ` ${days} days`;\n    if(hours > 0) timelimit += ` ${hours} hours`;\n    if(minutes > 0) timelimit += ` ${minutes} minutes`;\n    this.setState({\n      [e.target.name]: e.target.value,\n      timelimit: timelimit\n    })\n  }\n\n  render() {\n    const {\n      title,\n      desc,\n      choice1,\n      choice2,\n      choice3,\n      choice4,\n      votingPeriod,\n      error\n    } = this.state;\n\n    return (\n      <Layout pageTitle='Create Poll'>\n        <h4 className='page-header'><FontAwesomeIcon icon={faPoll} /> Create Poll</h4>\n        <hr />\n        { error ?\n          <Alert variant='danger'>\n           <b>Error submitting poll</b>\n          </Alert> : null\n        }\n        <Form autoComplete='off' onSubmit={this.handleSubmit}>\n          <Form.Group>\n            <Form.Label>\n              Title\n            </Form.Label>\n            <Form.Control\n              value={title}\n              onChange={this.inputUpdate}\n              type='text' name='title' maxLength='100'\n              required\n            />\n          </Form.Group>\n          <Form.Group>\n            <Form.Label>\n              Description (Optional)\n            </Form.Label>\n            <Form.Control\n              value={desc}\n              onChange={this.inputUpdate}\n              style={{ 'maxHeight': '144px', minHeight: '72px' }}\n              as=\"textarea\" rows=\"3\" name='desc' maxLength='400'\n            />\n            <Form.Text>\n              Characters remaining: {400 - desc.length}\n            </Form.Text>\n          </Form.Group>\n          <Form.Row>\n            <Form.Group as={Col}>\n              <Form.Label>\n                Choice #1\n              </Form.Label>\n              <Form.Control\n                value={choice1}\n                onChange={this.inputUpdate}\n                type='text' name='choice1' maxLength='50'\n                required\n              />\n            </Form.Group>\n            <Form.Group as={Col}>\n              <Form.Label>\n                Choice #2\n              </Form.Label>\n              <Form.Control\n                value={choice2}\n                onChange={this.inputUpdate} \n                type='text' name='choice2' maxLength='50'\n                required\n              />\n            </Form.Group>\n          </Form.Row>\n          <Form.Row>\n            <Form.Group as={Col}>\n              <Form.Label>\n                Choice #3 (Optional)\n              </Form.Label>\n              <Form.Control\n                value={choice3}\n                onChange={this.inputUpdate}\n                type='text' name='choice3' maxLength='50'\n              />\n            </Form.Group>\n            <Form.Group as={Col}>\n              <Form.Label>\n                Choice #4 (Optional)\n              </Form.Label>\n              <Form.Control\n                value={choice4}\n                onChange={this.inputUpdate}\n                type='text'name='choice4' maxLength='50'\n              />\n            </Form.Group>\n          </Form.Row>\n          <hr />\n          <Form.Row>\n            <Form.Group as={Col}>\n              <Form.Label>\n                Visibility <FontAwesomeIcon icon={faQuestionCircle} />\n              </Form.Label>\n              <Form.Check\n                onClick={this.visibilityUpdate}\n                type='radio' label='Public' name='visibility' value='public' defaultChecked\n              />\n              <Form.Check\n                onClick={this.visibilityUpdate}\n                type='radio' label='Private' name='visibility' value='private'\n              />\n            </Form.Group>\n            <Form.Group as={Col}>\n              <Form.Label>\n                Voting Period (hours) <FontAwesomeIcon icon={faQuestionCircle} />\n              </Form.Label>\n              <Form.Control\n                value={votingPeriod}\n                onChange={this.updateTimePeriod}\n                style={{ maxWidth: '200px' }}\n                type='number' min='6' max='72' name='votingPeriod'\n              />\n              <Form.Text>\n                6h - 72h \n              </Form.Text>\n            </Form.Group>\n\n          </Form.Row>\n          <div className='poll-preview'>\n            <h4 className='page-header'><FontAwesomeIcon icon={faEye} /> Preview</h4>\n            <hr />\n            <PollPreview {...this.state} />\n          </div>\n          <hr />\n          <Form.Group style={{ display: 'flex', justifyContent: 'center', marginTop: '2rem' }}>\n            <Button \n              variant='light-blue' type=\"submit\" style={{ width: '200px' }}>\n              Create Poll\n            </Button>\n          </Form.Group>\n        </Form>\n      </Layout>\n    )\n  }\n}\n\nexport default CreatePoll;"]},"metadata":{},"sourceType":"module"}