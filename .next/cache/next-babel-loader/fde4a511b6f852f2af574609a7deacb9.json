{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../components/Layout';\nimport fetch from 'isomorphic-unfetch';\nimport Link from 'next/link';\nimport Button from 'react-bootstrap/Button';\nimport Dropdown from 'react-bootstrap/Dropdown';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faFlag, faShare, faEllipsisV, faFilter } from '@fortawesome/free-solid-svg-icons';\nimport absoluteUrl from 'next-absolute-url';\nimport PollPagination from '../components/PollPagination';\nimport PollCard from '../components/PollCard';\nimport { withRouter } from 'next/router';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport VoteHistory from '../components/VoteHistory';\nimport Router from 'next/router';\nimport PollListFilter from '../components/PollListFilter';\n\nvar Home =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Home, _React$Component);\n\n  _createClass(Home, null, [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(ctx) {\n        var _absoluteUrl, origin, _ctx$query, page, state, queryString, i, name, value, res, data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _absoluteUrl = absoluteUrl(ctx.req), origin = _absoluteUrl.origin;\n                _ctx$query = ctx.query, page = _ctx$query.page, state = _ctx$query.state;\n                queryString = '';\n\n                for (i = 0; i < _Object$keys(ctx.query).length; i++) {\n                  name = _Object$keys(ctx.query)[i];\n                  value = ctx.query[_Object$keys(ctx.query)[i]];\n\n                  if (value !== undefined && value !== '') {\n                    if (i > 0) {\n                      queryString += '&';\n                    }\n\n                    queryString += \"\".concat(name, \"=\").concat(value);\n                  }\n                } // const searchPage = page < 1 || page == undefined ? 1 : page;\n\n\n                _context.next = 6;\n                return fetch(\"\".concat(origin, \"/api/v1/polls?\").concat(queryString), {\n                  method: 'POST'\n                });\n\n              case 6:\n                res = _context.sent;\n                _context.next = 9;\n                return res.json();\n\n              case 9:\n                data = _context.sent;\n                return _context.abrupt(\"return\", {\n                  polls: data.pollsArr,\n                  totalItems: data.totalItems\n                });\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  function Home(props) {\n    var _this;\n\n    _classCallCheck(this, Home);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Home).call(this, props));\n    _this.updateFilter = _this.updateFilter.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Home, [{\n    key: \"updateFilter\",\n    value: function updateFilter(eventKey) {\n      var state = this.props.router.query.state;\n      var href = '/?page=1';\n\n      if (state !== eventKey) {\n        href += \"&state=\".concat(eventKey);\n      }\n\n      var as = href;\n      Router.push(href, as);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          polls = _this$props.polls,\n          totalItems = _this$props.totalItems;\n      return __jsx(Layout, {\n        pageTitle: \"ThatPoll\",\n        path: this.props.router.asPath,\n        ads: true\n      }, __jsx(\"h4\", {\n        className: \"page-header\"\n      }, \"Recent Polls\"), __jsx(Row, null, __jsx(Col, {\n        md: 9\n      }, __jsx(PollListFilter, {\n        updateFilter: this.updateFilter,\n        query: this.props.router.query\n      }))), __jsx(\"hr\", null), __jsx(Row, null, __jsx(Col, {\n        md: 9\n      }, polls.length === 0 ? __jsx(\"div\", {\n        className: \"no-polls-card\"\n      }, __jsx(\"h4\", null, \"No Polls Found\")) : __jsx(\"div\", null, polls.map(function (poll, i) {\n        return __jsx(PollCard, {\n          key: i,\n          poll: poll\n        });\n      }), __jsx(PollPagination, {\n        totalItems: totalItems\n      }))), __jsx(Col, null, __jsx(VoteHistory, null))));\n    }\n  }]);\n\n  return Home;\n}(React.Component);\n\nexport default withRouter(Home);","map":{"version":3,"sources":["E:/Users/Jordan/Desktop/thatpoll/pages/index.js"],"names":["Layout","fetch","Link","Button","Dropdown","FontAwesomeIcon","faFlag","faShare","faEllipsisV","faFilter","absoluteUrl","PollPagination","PollCard","withRouter","Row","Col","VoteHistory","Router","PollListFilter","Home","ctx","req","origin","query","page","state","queryString","i","length","name","value","undefined","method","res","json","data","polls","pollsArr","totalItems","props","updateFilter","bind","eventKey","router","href","as","push","asPath","map","poll","React","Component"],"mappings":";;;;;;;;;;;AAAA,OAAOA,MAAP,MAAmB,sBAAnB;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,MAAP,MAAmB,wBAAnB;AACA,OAAOC,QAAP,MAAqB,0BAArB;AACA,SAASC,eAAT,QAAgC,gCAAhC;AACA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,WAA1B,EAAuCC,QAAvC,QAAuD,mCAAvD;AACA,OAAOC,WAAP,MAAwB,mBAAxB;AACA,OAAOC,cAAP,MAA2B,8BAA3B;AACA,OAAOC,QAAP,MAAqB,wBAArB;AACA,SAASC,UAAT,QAA2B,aAA3B;AACA,OAAOC,GAAP,MAAgB,qBAAhB;AACA,OAAOC,GAAP,MAAgB,qBAAhB;AACA,OAAOC,WAAP,MAAwB,2BAAxB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,cAAP,MAA2B,8BAA3B;;IAEMC,I;;;;;;;;;;gDACyBC,G;;;;;;;+BACRV,WAAW,CAACU,GAAG,CAACC,GAAL,C,EAAtBC,M,gBAAAA,M;6BACgBF,GAAG,CAACG,K,EAApBC,I,cAAAA,I,EAAMC,K,cAAAA,K;AACVC,gBAAAA,W,GAAc,E;;AAClB,qBAASC,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAG,aAAYP,GAAG,CAACG,KAAhB,EAAuBK,MAA3C,EAAmDD,CAAC,EAApD,EAAwD;AAClDE,kBAAAA,IADkD,GAC3C,aAAYT,GAAG,CAACG,KAAhB,EAAuBI,CAAvB,CAD2C;AAElDG,kBAAAA,KAFkD,GAE1CV,GAAG,CAACG,KAAJ,CAAU,aAAYH,GAAG,CAACG,KAAhB,EAAuBI,CAAvB,CAAV,CAF0C;;AAItD,sBAAIG,KAAK,KAAKC,SAAV,IAAuBD,KAAK,KAAK,EAArC,EAAyC;AACvC,wBAAIH,CAAC,GAAG,CAAR,EAAW;AACTD,sBAAAA,WAAW,IAAI,GAAf;AACD;;AACDA,oBAAAA,WAAW,cAAOG,IAAP,cAAeC,KAAf,CAAX;AACD;AAEF,iB,CACD;;;;uBAEkB7B,KAAK,WAAIqB,MAAJ,2BAA2BI,WAA3B,GAA0C;AAC/DM,kBAAAA,MAAM,EAAE;AADuD,iBAA1C,C;;;AAAjBC,gBAAAA,G;;uBAGaA,GAAG,CAACC,IAAJ,E;;;AAAbC,gBAAAA,I;iDAEC;AACLC,kBAAAA,KAAK,EAAED,IAAI,CAACE,QADP;AAELC,kBAAAA,UAAU,EAAEH,IAAI,CAACG;AAFZ,iB;;;;;;;;;;;;;;;;;;AAMT,gBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8EAAMA,KAAN;AAEA,UAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBC,IAAlB,+BAApB;AAHiB;AAIlB;;;;iCAEYC,Q,EAAU;AAAA,UACbjB,KADa,GACH,KAAKc,KAAL,CAAWI,MAAX,CAAkBpB,KADf,CACbE,KADa;AAErB,UAAImB,IAAI,GAAG,UAAX;;AACA,UAAInB,KAAK,KAAKiB,QAAd,EAAwB;AACtBE,QAAAA,IAAI,qBAAcF,QAAd,CAAJ;AACD;;AACD,UAAMG,EAAE,GAAGD,IAAX;AACA3B,MAAAA,MAAM,CAAC6B,IAAP,CAAYF,IAAZ,EAAkBC,EAAlB;AACD;;;6BAEQ;AAAA,wBACuB,KAAKN,KAD5B;AAAA,UACCH,KADD,eACCA,KADD;AAAA,UACQE,UADR,eACQA,UADR;AAEP,aACE,MAAC,MAAD;AACE,QAAA,SAAS,EAAC,UADZ;AAEE,QAAA,IAAI,EAAE,KAAKC,KAAL,CAAWI,MAAX,CAAkBI,MAF1B;AAGE,QAAA,GAAG,EAAE;AAHP,SAKE;AAAI,QAAA,SAAS,EAAC;AAAd,wBALF,EAME,MAAC,GAAD,QACE,MAAC,GAAD;AAAK,QAAA,EAAE,EAAE;AAAT,SACE,MAAC,cAAD;AAAgB,QAAA,YAAY,EAAE,KAAKP,YAAnC;AAAiD,QAAA,KAAK,EAAE,KAAKD,KAAL,CAAWI,MAAX,CAAkBpB;AAA1E,QADF,CADF,CANF,EAWE,iBAXF,EAaE,MAAC,GAAD,QACE,MAAC,GAAD;AAAK,QAAA,EAAE,EAAE;AAAT,SACIa,KAAK,CAACR,MAAN,KAAiB,CAAjB,GACA;AAAK,QAAA,SAAS,EAAC;AAAf,SACE,mCADF,CADA,GAKA,mBACGQ,KAAK,CAACY,GAAN,CAAU,UAACC,IAAD,EAAOtB,CAAP;AAAA,eACT,MAAC,QAAD;AAAU,UAAA,GAAG,EAAEA,CAAf;AAAkB,UAAA,IAAI,EAAEsB;AAAxB,UADS;AAAA,OAAV,CADH,EAIE,MAAC,cAAD;AAAgB,QAAA,UAAU,EAAEX;AAA5B,QAJF,CANJ,CADF,EAeE,MAAC,GAAD,QACE,MAAC,WAAD,OADF,CAfF,CAbF,CADF;AAmCD;;;;EAnFgBY,KAAK,CAACC,S;;AAsFzB,eAAetC,UAAU,CAACM,IAAD,CAAzB","sourcesContent":["import Layout from '../components/Layout';\nimport fetch from 'isomorphic-unfetch';\nimport Link from 'next/link';\nimport Button from 'react-bootstrap/Button';\nimport Dropdown from 'react-bootstrap/Dropdown';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faFlag, faShare, faEllipsisV, faFilter } from '@fortawesome/free-solid-svg-icons';\nimport absoluteUrl from 'next-absolute-url';\nimport PollPagination from '../components/PollPagination';\nimport PollCard from '../components/PollCard';\nimport { withRouter } from 'next/router';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport VoteHistory from '../components/VoteHistory';\nimport Router from 'next/router';\nimport PollListFilter from '../components/PollListFilter';\n\nclass Home extends React.Component {\n  static async getInitialProps(ctx) {\n    const { origin } = absoluteUrl(ctx.req);\n    const { page, state } = ctx.query;\n    let queryString = '';\n    for (let i = 0; i < Object.keys(ctx.query).length; i++) {\n      let name = Object.keys(ctx.query)[i];\n      let value = ctx.query[Object.keys(ctx.query)[i]];\n\n      if (value !== undefined && value !== '') {\n        if (i > 0) {\n          queryString += '&';\n        }\n        queryString += `${name}=${value}`;\n      }\n\n    }\n    // const searchPage = page < 1 || page == undefined ? 1 : page;\n\n    const res = await fetch(`${origin}/api/v1/polls?${queryString}`, {\n      method: 'POST',\n    });\n    const data = await res.json();\n  \n    return {\n      polls: data.pollsArr,\n      totalItems: data.totalItems\n    }\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.updateFilter = this.updateFilter.bind(this);\n  }\n\n  updateFilter(eventKey) {\n    const { state } = this.props.router.query;\n    let href = '/?page=1';\n    if (state !== eventKey) {\n      href += `&state=${eventKey}`\n    }\n    const as = href;\n    Router.push(href, as);\n  }\n\n  render() {\n    const { polls, totalItems } = this.props;\n    return (\n      <Layout\n        pageTitle='ThatPoll'\n        path={this.props.router.asPath}\n        ads={true}\n      >\n        <h4 className='page-header'>Recent Polls</h4>\n        <Row>\n          <Col md={9}>\n            <PollListFilter updateFilter={this.updateFilter} query={this.props.router.query} />\n          </Col>\n        </Row>\n        <hr />\n        \n        <Row>\n          <Col md={9}>\n            { polls.length === 0 ?\n              <div className='no-polls-card'>\n                <h4>No Polls Found</h4>\n              </div>\n            :\n              <div>\n                {polls.map((poll, i) => (\n                  <PollCard key={i} poll={poll} />\n                ))}\n                <PollPagination totalItems={totalItems} />\n              </div>\n            }\n          </Col>\n          <Col>\n            <VoteHistory />\n          </Col>\n        </Row>\n      </Layout>\n    )\n  }\n}\n\nexport default withRouter(Home)\n"]},"metadata":{},"sourceType":"module"}